<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shota Momma">

<title>Data wrangling using tidyr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="datawrangling_files/libs/clipboard/clipboard.min.js"></script>
<script src="datawrangling_files/libs/quarto-html/quarto.js"></script>
<script src="datawrangling_files/libs/quarto-html/popper.min.js"></script>
<script src="datawrangling_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="datawrangling_files/libs/quarto-html/anchor.min.js"></script>
<link href="datawrangling_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="datawrangling_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="datawrangling_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="datawrangling_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="datawrangling_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data wrangling using tidyr</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shota Momma </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<style>
p.note {
background-color: rgba(255,255,255,0.5);
padding: 10px;
border: 1px solid black;
margin-left: 0px;
border-radius: 1px;
font-style: italic;
}
</style>
<p>Throughout this course, we will make an extensive use of the programming language <em>R</em>. Here we will introduce the basic methods of loading, manipulating, summarizing and visualizing data using the <em>tidyverse</em> package, which may make your life a bit easier later on.</p>
<section id="dataset" class="level1">
<h1>Dataset</h1>
<p>We will use the acceptability norming dataset from Momma &amp; Yoshida (2023). The sentences like the following were used:</p>
<ul>
<li>Which movie did the critic watch and praise? [Across-The-Board movement]</li>
<li>Which movie did the critic watch before praising? [Parasitic gap sentences]</li>
</ul>
<p>The dataset also contains obviously good-sounding and obviously bad-sounding filler sentences of various types.</p>
</section>
<section id="loading-data-as-a-tibble-object." class="level1">
<h1>Loading data as a ‘tibble’ object.</h1>
<p>The data are stored in csv format, so you need to import them. To do so, you can use the function <em>read_csv()</em>. Note that this is different from the <em>read.csv()</em> function in base r. the <em>read_csv</em> function loads the data in a ‘tibble’ format, which is a table format often used in the tidyverse framework.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(tidyverse)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/shota/Documents/Teaching/Fall2024/Statistics/data/ATBvsPG.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,328 × 6
   Subj_ID                          Rating Sentence        Condi…¹ Item_ID List 
   &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;
 1 ddbc836a2df857339b8aa9115a6d93fb      6 Which policy d… ATB          33 A    
 2 ddbc836a2df857339b8aa9115a6d93fb      6 Which movie di… ATB           9 A    
 3 ddbc836a2df857339b8aa9115a6d93fb      7 Which manuscri… ATB           5 A    
 4 ddbc836a2df857339b8aa9115a6d93fb      6 Which vase did… ATB          39 A    
 5 ddbc836a2df857339b8aa9115a6d93fb      6 Which sculptur… ATB          15 A    
 6 ddbc836a2df857339b8aa9115a6d93fb      7 Which manuscri… ATB          21 A    
 7 ddbc836a2df857339b8aa9115a6d93fb      7 Which chair di… ATB          29 A    
 8 ddbc836a2df857339b8aa9115a6d93fb      7 Which question… ATB          49 A    
 9 ddbc836a2df857339b8aa9115a6d93fb      7 Which guitar d… ATB          11 A    
10 ddbc836a2df857339b8aa9115a6d93fb      7 Which car did … ATB          23 A    
# … with 3,318 more rows, and abbreviated variable name ¹​Condition</code></pre>
</div>
</div>
<p>A nice feature of a tibble format is that it tells you the type of each column, e.g., <chr> = character, <dbl> = double.</dbl></chr></p>
</section>
<section id="manipulating-and-summarizing-data-using-dplyr" class="level1">
<h1>Manipulating and summarizing data using dplyr</h1>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">filter()</h2>
<p>The dataset contains both filler and experimental sentences. Let’s say you want to create a data frame where the data from filler trials are removed. You can use the <em>filter()</em> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_exp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">'PG'</span> <span class="sc">|</span> Condition <span class="sc">==</span> <span class="st">'ATB'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,048 × 6
   Subj_ID                          Rating Sentence        Condi…¹ Item_ID List 
   &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;
 1 ddbc836a2df857339b8aa9115a6d93fb      6 Which policy d… ATB          33 A    
 2 ddbc836a2df857339b8aa9115a6d93fb      6 Which movie di… ATB           9 A    
 3 ddbc836a2df857339b8aa9115a6d93fb      7 Which manuscri… ATB           5 A    
 4 ddbc836a2df857339b8aa9115a6d93fb      6 Which vase did… ATB          39 A    
 5 ddbc836a2df857339b8aa9115a6d93fb      6 Which sculptur… ATB          15 A    
 6 ddbc836a2df857339b8aa9115a6d93fb      7 Which manuscri… ATB          21 A    
 7 ddbc836a2df857339b8aa9115a6d93fb      7 Which chair di… ATB          29 A    
 8 ddbc836a2df857339b8aa9115a6d93fb      7 Which question… ATB          49 A    
 9 ddbc836a2df857339b8aa9115a6d93fb      7 Which guitar d… ATB          11 A    
10 ddbc836a2df857339b8aa9115a6d93fb      7 Which car did … ATB          23 A    
# … with 2,038 more rows, and abbreviated variable name ¹​Condition</code></pre>
</div>
</div>
<p>%&gt;% is known as <em>pipe</em>, and it is an operator that takes the output of one function and passes it onto another function as an argument. The benefit of using this becomes clear in a minute.</p>
<p>You can also filter the data using a certain numerical threshold. Let’s say you want to subset the data so they only acceptability scores lower than 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_exp_low <span class="ot">&lt;-</span> df_exp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Rating <span class="sc">&lt;</span> <span class="dv">4</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_exp_low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 129 × 6
   Subj_ID                          Rating Sentence        Condi…¹ Item_ID List 
   &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;
 1 ddbc836a2df857339b8aa9115a6d93fb      1 Which movie di… ATB          43 A    
 2 ddbc836a2df857339b8aa9115a6d93fb      1 Which book did… ATB          27 A    
 3 49189b961f14912e503b9424d79991b0      3 Which guitar d… ATB          11 A    
 4 608824109a1b7d5ebbff3faa89f26f57      3 Which formula … ATB          31 A    
 5 608824109a1b7d5ebbff3faa89f26f57      3 Which girl did… ATB          61 A    
 6 608824109a1b7d5ebbff3faa89f26f57      3 Which movie di… ATB           9 A    
 7 608824109a1b7d5ebbff3faa89f26f57      3 Which question… ATB          49 A    
 8 608824109a1b7d5ebbff3faa89f26f57      2 Which horse di… ATB          25 A    
 9 608824109a1b7d5ebbff3faa89f26f57      3 Which cake did… ATB          17 A    
10 608824109a1b7d5ebbff3faa89f26f57      2 Which paper di… ATB          47 A    
# … with 119 more rows, and abbreviated variable name ¹​Condition</code></pre>
</div>
</div>
</section>
<section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select">select()</h2>
<p>Sometimes, you want to remove the columns that you don’t need. To do so, you can use the select() function from the <em>dplyr</em> package, which is included in the tidyverse package. To remove a column, you can use the ‘-’ operator. For example, suppose that you don’t want to remove the “Sentence” column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_clean <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Sentence)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,328 × 5
   Subj_ID                          Rating Condition Item_ID List 
   &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;
 1 ddbc836a2df857339b8aa9115a6d93fb      6 ATB            33 A    
 2 ddbc836a2df857339b8aa9115a6d93fb      6 ATB             9 A    
 3 ddbc836a2df857339b8aa9115a6d93fb      7 ATB             5 A    
 4 ddbc836a2df857339b8aa9115a6d93fb      6 ATB            39 A    
 5 ddbc836a2df857339b8aa9115a6d93fb      6 ATB            15 A    
 6 ddbc836a2df857339b8aa9115a6d93fb      7 ATB            21 A    
 7 ddbc836a2df857339b8aa9115a6d93fb      7 ATB            29 A    
 8 ddbc836a2df857339b8aa9115a6d93fb      7 ATB            49 A    
 9 ddbc836a2df857339b8aa9115a6d93fb      7 ATB            11 A    
10 ddbc836a2df857339b8aa9115a6d93fb      7 ATB            23 A    
# … with 3,318 more rows</code></pre>
</div>
</div>
<p>You can also keep the columns you want by simply telling which column you want to keep.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_subset <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(Subj_ID, Item_ID, Rating)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,328 × 3
   Subj_ID                          Item_ID Rating
   &lt;chr&gt;                              &lt;dbl&gt;  &lt;dbl&gt;
 1 ddbc836a2df857339b8aa9115a6d93fb      33      6
 2 ddbc836a2df857339b8aa9115a6d93fb       9      6
 3 ddbc836a2df857339b8aa9115a6d93fb       5      7
 4 ddbc836a2df857339b8aa9115a6d93fb      39      6
 5 ddbc836a2df857339b8aa9115a6d93fb      15      6
 6 ddbc836a2df857339b8aa9115a6d93fb      21      7
 7 ddbc836a2df857339b8aa9115a6d93fb      29      7
 8 ddbc836a2df857339b8aa9115a6d93fb      49      7
 9 ddbc836a2df857339b8aa9115a6d93fb      11      7
10 ddbc836a2df857339b8aa9115a6d93fb      23      7
# … with 3,318 more rows</code></pre>
</div>
</div>
</section>
<section id="group_by-summarize" class="level2">
<h2 class="anchored" data-anchor-id="group_by-summarize">group_by() %&gt;% summarize()</h2>
<p>Often, you want to compute descriptive statistics separately by condition, by subject, by item, etc. In such cases you can the combinations of two functions: group_by() and summarize(). For instance, you can compute the mean rating by condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mean_bycondition <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Rating))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mean_bycondition</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  Condition    mean
  &lt;chr&gt;       &lt;dbl&gt;
1 ATB          6.07
2 filler_bad   2.34
3 filler_good  6.18
4 PG           5.95</code></pre>
</div>
</div>
<p>You can also compute the mean rating by condition by subject.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mean_bycondition_bysubject <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Subj_ID, Condition) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Rating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Subj_ID'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mean_bycondition_bysubject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 128 × 3
# Groups:   Subj_ID [32]
   Subj_ID                          Condition    mean
   &lt;chr&gt;                            &lt;chr&gt;       &lt;dbl&gt;
 1 08db5078ac9dcf705b13ac28eb838e2d ATB          5.88
 2 08db5078ac9dcf705b13ac28eb838e2d filler_bad   2.04
 3 08db5078ac9dcf705b13ac28eb838e2d filler_good  5.93
 4 08db5078ac9dcf705b13ac28eb838e2d PG           5.34
 5 2d4c21f83c3728a4e4d53f58eae56a9a ATB          6.44
 6 2d4c21f83c3728a4e4d53f58eae56a9a filler_bad   1.36
 7 2d4c21f83c3728a4e4d53f58eae56a9a filler_good  6.47
 8 2d4c21f83c3728a4e4d53f58eae56a9a PG           6.41
 9 3b3b63a75981b844f04ce7452361e2db ATB          5.88
10 3b3b63a75981b844f04ce7452361e2db filler_bad   1.24
# … with 118 more rows</code></pre>
</div>
</div>
<p>You can also compute various descriptive statistics simultaneously. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>descriptive_stats_by_condition <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Rating), <span class="at">median =</span> <span class="fu">median</span>(Rating), <span class="at">sd =</span> <span class="fu">sd</span>(Rating), <span class="at">max =</span> <span class="fu">max</span>(Rating), <span class="at">min =</span> <span class="fu">min</span>(Rating))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>descriptive_stats_by_condition</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  Condition    mean median    sd   max   min
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 ATB          6.07      7  1.31     7     1
2 filler_bad   2.34      2  1.76     7     1
3 filler_good  6.18      7  1.40     7     1
4 PG           5.95      7  1.36     7     1</code></pre>
</div>
</div>
<p>The benefit of using the pipe operator is that you can chain multiple operations. For instance, you can first filter the dataset and then compute the descriptive statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>desc_stats <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">'PG'</span> <span class="sc">|</span> Condition <span class="sc">==</span> <span class="st">'ATB'</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Rating))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>desc_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  Condition  mean
  &lt;chr&gt;     &lt;dbl&gt;
1 ATB        6.07
2 PG         5.95</code></pre>
</div>
</div>
</section>
<section id="mutate" class="level2">
<h2 class="anchored" data-anchor-id="mutate">mutate()</h2>
<p>You sometimes want to create a new column by using information in the other columns. In that case, you can use the mutate() function. For instance, suppose that you want to add a column with standardized rating scores (<em>z-score</em>, i.e., how many standard deviations away from the mean a value is) by subject. This is often useful when analyzing acceptability judgment data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_stan <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Subj_ID) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Rating_z =</span> <span class="fu">scale</span>(Rating)) </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_stan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,328 × 7
# Groups:   Subj_ID [32]
   Subj_ID                          Rating Sente…¹ Condi…² Item_ID List  Ratin…³
   &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
 1 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB          33 A       0.383
 2 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB           9 A       0.383
 3 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB           5 A       0.752
 4 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB          39 A       0.383
 5 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB          15 A       0.383
 6 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          21 A       0.752
 7 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          29 A       0.752
 8 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          49 A       0.752
 9 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          11 A       0.752
10 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          23 A       0.752
# … with 3,318 more rows, and abbreviated variable names ¹​Sentence, ²​Condition,
#   ³​Rating_z[,1]</code></pre>
</div>
</div>
</section>
<section id="define-your-own-function" class="level2">
<h2 class="anchored" data-anchor-id="define-your-own-function">define your own function</h2>
<p>It is useful to know how to define your own function in R. As an exercise, let’s define a function that computes a z-score (that’s what the scale() function does).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## equivalently:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="cf">function</span>(vec){</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    (vec <span class="sc">-</span> <span class="fu">mean</span>(vec))<span class="sc">/</span><span class="fu">sd</span>(vec)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>df_stan2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Subj_ID) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Rating_z =</span> <span class="fu">z</span>(Rating)) </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>df_stan2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,328 × 7
# Groups:   Subj_ID [32]
   Subj_ID                          Rating Sente…¹ Condi…² Item_ID List  Ratin…³
   &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
 1 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB          33 A       0.383
 2 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB           9 A       0.383
 3 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB           5 A       0.752
 4 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB          39 A       0.383
 5 ddbc836a2df857339b8aa9115a6d93fb      6 Which … ATB          15 A       0.383
 6 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          21 A       0.752
 7 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          29 A       0.752
 8 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          49 A       0.752
 9 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          11 A       0.752
10 ddbc836a2df857339b8aa9115a6d93fb      7 Which … ATB          23 A       0.752
# … with 3,318 more rows, and abbreviated variable names ¹​Sentence, ²​Condition,
#   ³​Rating_z</code></pre>
</div>
</div>
</section>
</section>
<section id="data-visualization-using-ggplot2" class="level1">
<h1>Data visualization using ggplot2</h1>
<p>It’s always useful to visualize your data to understand what’s going on. The tidiverse package comes with a package named ggplot2, and it is a powerful tool for data visualization. There are a whole bunch of things we can do with ggplot2, but we are gonna create two basic types of graphs for now.</p>
<p>Let’s first make a histogram. Histograms are pretty useful for visualizing how a variable of interest is distributed, and often, the first thing you want to do with your data is to create the histogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_exp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">'ATB'</span><span class="sc">|</span> Condition <span class="sc">==</span> <span class="st">'PG'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_exp) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Rating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="datawrangling_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can also craete two graphs by conditions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_exp) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Rating)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="datawrangling_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sometimes, you may want to look at subject-wise or item-wise distributions. Let’s take a look at the distribution of average ratings of the bad filler sentences by subject.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_subj <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">'filler_bad'</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Subj_ID) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_rating =</span> <span class="fu">mean</span>(Rating))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_subj) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_rating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="datawrangling_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You may notice that 1 subject didn’t really judge bad fillers as bad. This may be a signal that that person didn’t really pay attention to the task. Generally, plotting distributions is very useful for noticing something odd in your data.</p>
<p>Another widely used type of plots are bar plots. Barplots can be created by using the geom_barplot() function. Say you want to plot the mean ratings of each condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Condition, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ATB"</span>,<span class="st">"PG"</span>, <span class="st">"filler_good"</span>, <span class="st">"filler_bad"</span>) ) <span class="co"># let's reorder the factor</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_means <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_rating =</span> <span class="fu">mean</span>(Rating))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_means, <span class="fu">aes</span>(<span class="at">x =</span> Condition,<span class="at">y =</span> mean_rating)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="datawrangling_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Barplots are useful (especially when you put error bars - we don’t put error bars here because computing ‘errors’ is actually complicated. We will come back to this issue later), but they do not contain any information about how variables are distributed. In some cases, you may want to make a boxplot instead:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_boxplot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Subj_ID, Condition) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_rating =</span> <span class="fu">mean</span>(Rating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Subj_ID'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_boxplot) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Condition,<span class="at">y =</span> mean_rating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="datawrangling_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="hw-exercise-do-this-by-the-next-class" class="level1">
<h1>HW exercise (do this by the next class)</h1>
<ol type="1">
<li><p>Compute the mean and the standard deviation of the z-scored acceptability rating using group_by() %&gt;% summarize(). z-score should be computed for each subject separately.</p></li>
<li><p>Suppose that you want to identify ‘bad’ subjects, who did not reliably discriminate between good and bad filler sentences. Using various functions introduced above, create a tibble object that shows mean rating differences between good and bad filler sentences for each subject.</p></li>
<li><p>Do the same but for each item instead of for each subject.</p></li>
<li><p>Create a boxplot plotting the acceptability rating by condition, where each data point corresponds to an item (rather than subject) average.</p></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>